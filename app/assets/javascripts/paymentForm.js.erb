

function renderPaymentModal ( elementId, amount, currency) {
	console.log('now in renderPaymentModal');

	file = location.pathname.split( "/" ).pop();

	link = document.createElement( "link" );
	// link.href = file.substr( 0, file.lastIndexOf( "." ) ) + ".css";
	link.href = "../stylesheets/modal.css";
	link.type = "text/css";
	link.rel = "stylesheet";

	var btScript = document.createElement("script");
	btScript.type = "text/javascript";
	btScript.src = "<script src='https://js.braintreegateway.com/js/braintree-2.21.0.min.js'></script>";

	document.getElementsByTagName("head")[0].appendChild(link);
	// document.getElementsByTagName("head")[0].appendChild(btScript);

	console.log("Braintree script has loaded.. hopefully...");
	console.log(document.getElementsByTagName("head")[0]);
		// console.log("DOM content has loaded");
		// document.write('<script src="https://js.braintreegateway.com/js/braintree-2.21.0.min.js"></script>');
		// document.getElementsByTagName( "head" )[0].appendChild('<script src="https://js.braintreegateway.com/js/braintree-2.21.0.min.js"></script>');

	var   
	pay = document.getElementById(elementId),
	divOpen = "<div id='formModal'>",
	formOpen = "<form method='POST' action='/payment'>",
	ccInput = "<div id='payment-form'></div><br>",
	closeButton = "<span id='close'>X</span>",
	hiddenAmount = "<input type='hidden' value=" + amount + ">",
	hiddenCurrency = "<input type='hidden' value=" + currency + ">",	
	submitButton = "<input type='submit' value='Submit'>",
	formClose = "</form>",
	divClose = "</div>",
	modalBtn = "<button id='checkoutBtn'>Pay using our platform.</button>",
	content = divOpen + formOpen + closeButton + ccInput + hiddenAmount + hiddenCurrency + submitButton + formClose + divClose + modalBtn;

	pay.innerHTML = content;
	// console.log(pay.innerHTML);

	// Get the modal
	var modal = document.getElementById("formModal");

	// Get the button that opens the modal
	var btn = document.getElementById("checkoutBtn");

	// Get the <span> element that closes the modal
	var span = document.getElementById("close");

	// When the user clicks on the button, open the modal 
	btn.addEventListener('click', function() {
	    modal.style.display = "block";
	    console.log("it works");
	})

	// When the user clicks on <span> (x), close the modal
	span.addEventListener('click', function() {
		console.log("span clicked");
	    modal.style.display = "none";
	})

	// When the user clicks anywhere outside of the modal, close it
	window.addEventListener('click', function(event) {
	    if (event.target == modal) {
	    	console.log("Clicked outside modal");
	        modal.style.display = "none";
	    }
	})

	// console.log(document.getElementsByTagName("head")[0][document.getElementsByTagName("head")[0].length-1])

}

// renderPaymentModal('pay', 100, 'USD');

